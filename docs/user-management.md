# 用户管理功能说明文档

## 功能概述

用户管理模块提供了用户注册、登录、查询用户信息和充值等基本功能，为系统提供用户身份认证和账户管理服务。

## 数据库设计

### 用户表（user）

| 字段名 | 类型 | 说明 |
| ----- | ---- | ---- |
| id | BIGINT | 用户ID，主键，自增 |
| username | VARCHAR(50) | 用户名，唯一 |
| password | VARCHAR(100) | 密码 |
| phone | VARCHAR(20) | 手机号 |
| email | VARCHAR(100) | 邮箱 |
| balance | DECIMAL(10, 2) | 账户余额 |
| status | TINYINT | 用户状态：0-禁用，1-正常 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

### 充值记录表（recharge_record）

| 字段名 | 类型 | 说明 |
| ----- | ---- | ---- |
| id | BIGINT | 记录ID，主键，自增 |
| user_id | BIGINT | 用户ID，外键 |
| amount | DECIMAL(10, 2) | 充值金额 |
| before_balance | DECIMAL(10, 2) | 充值前余额 |
| after_balance | DECIMAL(10, 2) | 充值后余额 |
| status | TINYINT | 充值状态：0-失败，1-成功 |
| pay_type | TINYINT | 充值方式：1-支付宝，2-微信，3-银行卡 |
| trade_no | VARCHAR(64) | 交易流水号 |
| remark | VARCHAR(255) | 备注 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

## 功能说明

### 1. 用户注册

用户通过提供用户名、密码、确认密码、手机号和邮箱等信息进行注册。系统会验证用户名是否已存在，两次密码是否一致，以及其他字段的格式是否正确。注册成功后，系统会返回用户ID。

**业务规则：**
- 用户名长度必须在4-20个字符之间，且不能重复
- 密码长度必须在6-20个字符之间
- 两次输入的密码必须一致
- 手机号必须符合中国大陆手机号格式（11位数字）
- 邮箱必须符合标准邮箱格式

### 2. 用户登录

用户通过提供用户名和密码进行登录。系统会验证用户名和密码是否正确，以及用户状态是否正常。登录成功后，系统会返回用户的基本信息。

**业务规则：**
- 用户名和密码不能为空
- 用户名必须存在
- 密码必须正确
- 用户状态必须为正常（status=1）

### 3. 获取用户信息

通过用户ID获取用户的基本信息，包括用户名、手机号、邮箱、账户余额和状态等。

**业务规则：**
- 用户ID必须存在

### 4. 用户充值

用户通过选择充值方式和输入充值金额进行账户充值。系统会记录充值前后的余额变化，并生成交易流水号。

**业务规则：**
- 用户ID必须存在
- 充值金额必须大于0
- 充值方式必须在系统支持的范围内（1-支付宝，2-微信，3-银行卡）
- 充值成功后，用户余额会增加相应的金额
- 系统会记录充值的详细信息，包括充值前后的余额、交易流水号等

### 5. 检查用户名是否存在

在用户注册过程中，可以通过此功能检查用户名是否已被使用，以便用户及时调整。

**业务规则：**
- 用户名不能为空

### 6. 获取用户列表

管理员可以通过此功能获取系统中的用户列表，支持按用户名模糊查询和用户状态筛选，并提供分页功能。

**业务规则：**
- 支持按用户名进行模糊查询
- 支持按用户状态（正常/禁用）进行筛选
- 提供分页功能，默认每页10条记录
- 返回用户列表和总记录数
- 用户列表按创建时间降序排序

## 接口说明

详细的API接口说明请参考 [用户管理API文档](user-api.md)。

## 前端对接指南

### 注册流程

1. 前端在用户输入用户名后，可以调用"检查用户名是否存在"接口进行实时验证
2. 用户填写完所有信息后，前端需要验证两次密码是否一致
3. 验证通过后，调用"用户注册"接口提交注册信息
4. 根据接口返回结果，显示注册成功或失败信息

### 登录流程

1. 用户输入用户名和密码
2. 调用"用户登录"接口进行验证
3. 登录成功后，前端可以保存用户ID和其他必要信息，用于后续操作
4. 登录失败时，根据错误信息提示用户

### 充值流程

1. 用户选择充值方式和输入充值金额
2. 调用"用户充值"接口提交充值请求
3. 充值成功后，显示新的账户余额
4. 充值失败时，根据错误信息提示用户

### 用户列表展示

1. 页面加载时，调用"获取用户列表"接口获取第一页数据
2. 用户可以通过输入用户名和选择状态进行筛选
3. 用户可以通过分页控件切换不同页码
4. 每次筛选条件或页码变化时，重新调用接口获取数据

## 注意事项

1. 密码在前端传输和后端存储时均为明文，实际生产环境中应该使用加密方式
2. 用户登录后的身份认证采用简单方式，没有使用JWT等token机制
3. 充值功能为模拟实现，没有对接实际的支付网关
4. 所有接口的错误处理采用统一的响应格式，便于前端解析和处理
5. 用户列表功能应该只对管理员开放，实际项目中应添加权限控制 